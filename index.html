<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Styles on css folder -->
  <link href="css/libs.css" rel="stylesheet" />
  <meta charset="utf-8" />
  <link rel="icon" href="img/favicon.png" />
  <title>HTML | Portal</title>
  <link rel="stylesheet" href="css/toastr.css" /> 
  <link rel="stylesheet" href="css/grapes.css" />
  <link rel="stylesheet" href="css/preset.css" />
  <link rel="stylesheet" href="css/tooltip.css" />
  <link rel="stylesheet" href="css/demo.css" />
  <link href="css/grapic.css" rel="stylesheet" /> 
  <link href="css/common.css" rel="stylesheet" />
  <link href="css/colorpicker.css" rel="stylesheet" />
  <link href="css/imageediter.css" rel="stylesheet" />
  <link rel="stylesheet" type="text/css" href="portal.css">
  <!-- <link href="css/mincss0213/css" rel="stylesheet" /> -->

  <!--  -->



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/htmlmixed/htmlmixed.min.js"></script>

  <script src="https://kit.fontawesome.com/af9acd004f.js" crossorigin="anonymous"></script>

  <!-- Script on js folder -->
  <!-- <script src="js/restarg.js"></script> -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.7.1/jszip.min.js"></script>
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script> -->

  
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="importForm.js"></script>
 <script src="js/aes.js"></script>
  
  <script src="js/custom.js"></script> 
  <script src="saveAndEdit.js"></script>
  <script src="js/code-dom.js"></script>
  <script src="js/analytics.js"></script>
  <script src="js/jquery.js"></script>
  <script src="js/toastr.js"></script>
  <script src="js/grapes.js"></script>
  <script src="js/webpage.js"></script>
  <script src="js/export.js"></script>
  <script src="js/blocks.js"></script>
  <script src="js/form.js"></script>
  <script src="js/countdown.js"></script>
  <script src="https://kit.fontawesome.com/20c5629a29.js" crossorigin="anonymous"></script>
  <script src="js/tabs.js"></script>
  <script src="js/code.js"></script>
  <script src="js/touch.js"></script>
  <script src="js/postcss.js"></script>
  <script src="js/tooltip.js"></script>
  <script src="js/editer.js"></script>
  <script src="js/type.js"></script>
  <script src="js/grapesjs.js"></script>
  <script src="js/snippet.js"></script>
  <script src="js/colorpicker.js"></script>
  <script src="js/imageediter.js"></script>
  <script src="portal.js"></script>
  



   

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  
</head>

<body>
  <div id="loading-indicator"></div>

 <!-- <div class="header" id="header" >
      <div class="header_content">
          <i class="fas fa-globe fa-2xl"></i>
          <div class="header_text">
            <p id="title_content" class="header_paragrp"></p> <p id="description" class="header_paragrp description">portal description</p>
          </div>
        <div class="Button_Container">
          <button id='previewBtn' class="previewBtn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye eyeicons" viewBox="0 0 16 16" style="stroke: #f1f5f9;stroke-width: 1px;">
              <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
              <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
            </svg>Preview
          </button> 
          <button id="saveBtn"  class="saveBtn"> 
            <i class="fa-regular fa-floppy-disk fa-lg" style="color: #ffffff; padding-right:10px"></i>
            save
          </button>
        </div>
      </div>
  </div> -->


  <div id="gjs" style="height:100%; display: block; overflow: hidden; width: 100%" class="gjs-editor-cont">
  </div>
</body>
<!-- Main Script -->
<script>
  // Function to check and load preview.html if the URL contains the "preview" parameter
  function loadPreview() {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has('viewer')) {
        window.location.href = 'viewer.html';
      }
  }

  // Call the function to check and load preview.html
  loadPreview();
</script>
<script type="text/javascript">
  var lp = "./img/";
  var plp = "https://via.placeholder.com/350x250/";
  var images = [
    lp + "team1.jpg",
    lp + "team2.jpg",
    lp + "team3.jpg",
    plp + "78c5d6/fff",
    plp + "459ba8/fff",
    plp + "79c267/fff",
    plp + "c5d647/fff",
    plp + "f28c33/fff",
    plp + "e868a2/fff",
    plp + "cc4360/fff",
    lp + "work-desk.jpg",
    lp + "phone-app.png",
    lp + "bg-gr-v.png",
  ];

  var editor = grapesjs.init({
    height: "100%",
    container: "#gjs",
    fromElement: true,
    showOffsets: true,
    assetManager: {
      embedAsBase64: true,
      assets: images,
    },
    selectorManager: { componentFirst: true },
    styleManager: {
      sectors: [
        {
          name: "General",

          properties: [
            {
              extend: "float",
              type: "select",
              default: "none",
              options: [
                { value: "none", className: "fa fa-times" },
                { value: "left", className: "fa fa-align-left" },
                { value: "right", className: "fa fa-align-right" },
              ],
            },
            "display",
            { extend: "position", type: "select" },
            "top",
            "right",
            "left",
            "bottom",
          ],
        },
        {
          name: "Dimension",
          open: false,
          properties: [
            "width",
            {
              id: "flex-width",
              type: "integer",
              name: "Width",
              units: ["px", "%"],
              property: "flex-basis",
              toRequire: 1,
            },
            "height",
            "max-width",
            "min-height",
            "margin",
            "padding",
          ],
        },
        {
          name: "Typography",
          open: false,
          properties: [
            "font-family",
            "font-size",
            "font-weight",
            "letter-spacing",
            "color",
            "line-height",
            {
              extend: "text-align",
              options: [
                {
                  id: "left",
                  label: "Left",
                  className: "fa fa-align-left",
                },
                {
                  id: "center",
                  label: "Center",
                  className: "fa fa-align-center",
                },
                {
                  id: "right",
                  label: "Right",
                  className: "fa fa-align-right",
                },
                {
                  id: "justify",
                  label: "Justify",
                  className: "fa fa-align-justify",
                },
              ],
            },
            {
              property: "text-decoration",
              type: "radio",
              default: "none",
              options: [
                { id: "none", label: "None", className: "fa fa-times" },
                {
                  id: "underline",
                  label: "underline",
                  className: "fa fa-underline",
                },
                {
                  id: "line-through",
                  label: "Line-through",
                  className: "fa fa-strikethrough",
                },
              ],
            },
            "text-shadow",
          ],
        },
        {
          name: "Decorations",
          open: false,
          properties: [
            "opacity",
            "border-radius",
            "border",
            "box-shadow",
            "background", // { id: 'background-bg', property: 'background', type: 'bg' }
          ],
        },
        {
          name: "Countdown",
          open: false,
          buildProps: ["transition", "perspective", "transform"],
        },
        {
          name: "Flex",
          open: false,
          properties: [
            {
              name: "Flex Container",
              property: "display",
              type: "select",
              defaults: "block",
              list: [
                { value: "block", name: "Disable" },
                { value: "flex", name: "Enable" },
              ],
            },
            {
              name: "Flex Parent",
              property: "label-parent-flex",
              type: "integer",
            },
            {
              name: "Direction",
              property: "flex-direction",
              type: "select", //radio
              defaults: "row",
              list: [
                {
                  value: "row",
                  name: "Row",
                  className: "icons-flex icon-dir-row",
                  title: "Row",
                },
                {
                  value: "row-reverse",
                  name: "Row reverse",
                  className: "icons-flex icon-dir-row-rev",
                  title: "Row reverse",
                },
                {
                  value: "column",
                  name: "Column",
                  title: "Column",
                  className: "icons-flex icon-dir-col",
                },
                {
                  value: "column-reverse",
                  name: "Column reverse",
                  title: "Column reverse",
                  className: "icons-flex icon-dir-col-rev",
                },
              ],
            },
            {
              name: "Justify",
              property: "justify-content",
              type: "select",
              defaults: "flex-start",
              list: [
                {
                  value: "flex-start",
                  className: "icons-flex icon-just-start",
                  title: "Start",
                },
                {
                  value: "flex-end",
                  title: "End",
                  className: "icons-flex icon-just-end",
                },
                {
                  value: "space-between",
                  title: "Space between",
                  className: "icons-flex icon-just-sp-bet",
                },
                {
                  value: "space-around",
                  title: "Space around",
                  className: "icons-flex icon-just-sp-ar",
                },
                {
                  value: "center",
                  title: "Center",
                  className: "icons-flex icon-just-sp-cent",
                },
              ],
            },
            {
              name: "Align",
              property: "align-items",
              type: "select",
              defaults: "center",
              list: [
                {
                  value: "flex-start",
                  title: "Start",
                  className: "icons-flex icon-al-start",
                },
                {
                  value: "flex-end",
                  title: "End",
                  className: "icons-flex icon-al-end",
                },
                {
                  value: "stretch",
                  title: "Stretch",
                  className: "icons-flex icon-al-str",
                },
                {
                  value: "center",
                  title: "Center",
                  className: "icons-flex icon-al-center",
                },
              ],
            },
            {
              name: "Flex Children",
              property: "label-parent-flex",
              type: "integer",
            },
            {
              name: "Order",
              property: "order",
              type: "integer",
              defaults: 0,
              min: 0,
            },
            {
              name: "Flex",
              property: "flex",
              type: "composite",
              properties: [
                {
                  name: "Grow",
                  property: "flex-grow",
                  type: "integer",
                  defaults: 0,
                  min: 0,
                },
                {
                  name: "Shrink",
                  property: "flex-shrink",
                  type: "integer",
                  defaults: 0,
                  min: 0,
                },
                {
                  name: "Basis",
                  property: "flex-basis",
                  type: "integer",
                  units: ["px", "%", ""],
                  unit: "",
                  defaults: "auto",
                },
              ],
            },
            {
              name: "Align Self",
              property: "align-self",
              type: "select",
              defaults: "auto",
              list: [
                {
                  value: "auto",
                  name: "Auto",
                },
                {
                  value: "flex-start",
                  title: "Start",
                  className: "icons-flex icon-al-start",
                },
                {
                  value: "flex-end",
                  title: "End",
                  className: "icons-flex icon-al-end",
                },
                {
                  value: "stretch",
                  title: "Stretch",
                  className: "icons-flex icon-al-str",
                },
                {
                  value: "center",
                  title: "Center",
                  className: "icons-flex icon-al-center",
                },
              ],
            },
          ],
        },
      ],
    },
    plugins: [
      "gjs-blocks-basic",
      "grapesjs-plugin-forms",
      "grapesjs-component-countdown",
      "grapesjs-plugin-export",
      "grapesjs-tabs",
      "grapesjs-custom-code",
      "grapesjs-touch",
      "grapesjs-parser-postcss",
      "grapesjs-tooltip",
      "grapesjs-tui-image-editor",
      "grapesjs-typed",
      "grapesjs-style-bg",
      "grapesjs-preset-webpage",
    ],
    pluginsOpts: {
      "gjs-blocks-basic": { flexGrid: true },
      "grapesjs-tui-image-editor": {
        script: [
          // 'https://cdnjs.cloudflare.com/ajax/libs/fabric.js/1.6.7/fabric.min.js',
          "https://uicdn.toast.com/tui.code-snippet/v1.5.2/tui-code-snippet.min.js",
          "https://uicdn.toast.com/tui-color-picker/v2.2.7/tui-color-picker.min.js",
          "https://uicdn.toast.com/tui-image-editor/v3.15.2/tui-image-editor.min.js",
        ],
        style: [
          "https://uicdn.toast.com/tui-color-picker/v2.2.7/tui-color-picker.min.css",
          "https://uicdn.toast.com/tui-image-editor/v3.15.2/tui-image-editor.min.css",
        ],
      },
      "grapesjs-tabs": {
        tabsBlock: { category: "Extra" },
      },
      "grapesjs-typed": {
        block: {
          category: "Extra",
          content: {
            type: "typed",
            "type-speed": 40,
            strings: ["Text row one", "Text row two", "Text row three"],
          },
        },
      },
      "grapesjs-preset-webpage": {
        modalImportTitle: "Import Template",
        modalImportLabel:
            '<div id="fileUploadContainer">'+
        '<h4>Upload HTML and CSS Files</h4> <div style="display:flex;"> '+
       ' <div>'+
        '    <label for="htmlFileInput" class="file-input-label">Choose HTML Files</label>'+
         '   <input type="file" id="htmlFileInput" class="file-input-button" accept=".html" multiple>'+
         '  <div style="width:11vw;"><div id="htmlMessage"></div>'+
          '  <ol id="htmlFileList"></ol></div>'+
         '</div>'+
         '<div>'+
          '<label for="cssFileInput" class="file-input-label">Choose CSS Files</label>'+
          ' <input type="file" id="cssFileInput" accept=".css" class="file-input-button" multiple>'+
          '  <div><div id="cssMessage"></div>'+
           '<ol id="cssFileList"></ol> </div>'+
          '</div> </div>'+
          '<button class="mergebtn" onclick="merge()">Upload Files</button>'+
          ' </div>'+
    '<div id="downloadContainer"></div>  <div id="editor"></div>',
        modalImportContent: function (editor) {
          return editor.getHtml() + "<style>" + editor.getCss() + "</style>";
        },
      },
    },
  });

  editor.I18n.addMessages({
    en: {
      styleManager: {
        properties: {
          "background-repeat": "Repeat",
          "background-position": "Position",
          "background-attachment": "Attachment",
          "background-size": "Size",
        },
      },
    },
  });

  var pn = editor.Panels;
  var modal = editor.Modal;
  var cmdm = editor.Commands;

  // Update canvas-clear command
  cmdm.add("canvas-clear", function () {
    editor.runCommand("core:canvas-clear");
      setTimeout(function () {
        localStorage.removeItem('ezofisPortalProject');
      }, 0);
  });

  // Add info command
  var mdlClass = "gjs-mdl-dialog-sm";
  var infoContainer = document.getElementById("info-panel");

  cmdm.add("open-info", function () {
    var mdlDialog = document.querySelector(".gjs-mdl-dialog");
    mdlDialog.className += " " + mdlClass;
    infoContainer.style.display = "block";
    modal.setTitle("About this demo");
    modal.setContent(infoContainer);
    modal.open();
    modal.getModel().once("change:open", function () {
      mdlDialog.className = mdlDialog.className.replace(mdlClass, "");
    });
  });

  pn.addButton("options", {
    id: "open-info",
    className: "fa fa-question-circle",
    command: function () {
      editor.runCommand("open-info");
    },
    attributes: {
      title: "About",
      "data-tooltip-pos": "bottom",
    },
  });

  // Simple warn notifier
  var origWarn = console.warn;
  toastr.options = {
    closeButton: true,
    preventDuplicates: true,
    showDuration: 250,
    hideDuration: 150,
  };
  console.warn = function (msg) {
    if (msg.indexOf("[undefined]") == -1) {
      toastr.warning(msg);
    }
    origWarn(msg);
  };

  // Add and beautify tooltips
  [
    ["sw-visibility", "Show Borders"],
    ["preview", "Preview"],
    ["fullscreen", "Fullscreen"],
    ["export-template", "Export"],
    ["undo", "Undo"],
    ["redo", "Redo"],
    ["gjs-open-import-webpage", "Import"],
    ["canvas-clear", "Clear canvas"],
  ].forEach(function (item) {
    pn.getButton("options", item[0]).set("attributes", {
      title: item[1],
      "data-tooltip-pos": "bottom",
    });
  });
  [
    ["open-sm", "Style Manager"],
    ["open-layers", "Layers"],
    ["open-blocks", "Blocks"],
  ].forEach(function (item) {
    pn.getButton("views", item[0]).set("attributes", {
      title: item[1],
      "data-tooltip-pos": "bottom",
    });
  });
  var titles = document.querySelectorAll("*[title]");

  for (var i = 0; i < titles.length; i++) {
    var el = titles[i];
    var title = el.getAttribute("title");
    title = title ? title.trim() : "";
    if (!title) break;
    el.setAttribute("data-tooltip", title);
    el.setAttribute("title", "");
  }
  // Store and load events
  editor.on("storage:load", function (e) {
    console.log("Loaded ", e);
  });
  editor.on("storage:store", function (e) {
    console.log("Stored ", e);
  });

  // Do stuff on load
  editor.on("load", function () {
    var $ = grapesjs.$;

    // Show borders by default
    pn.getButton("options", "sw-visibility").set("active", 1);

    // Show logo with the version
    var logoCont = document.querySelector(".gjs-logo-cont");
    document.querySelector(".gjs-logo-version").innerHTML =
      "v" + grapesjs.version;
    var logoPanel = document.querySelector(".gjs-pn-commands");
    logoPanel.appendChild(logoCont);

    // Load and show settings and style manager
    var openTmBtn = pn.getButton("views", "open-tm");
    openTmBtn && openTmBtn.set("active", 1);
    var openSm = pn.getButton("views", "open-sm");
    openSm && openSm.set("active", 1);

    // Remove trait view
    pn.removeButton("views", "open-tm");

    //Add Settings Sector
    var traitsSector = $(
      '<div class="gjs-sm-sector no-select gjs-sm-sector__Setting">' +
        '<div class="gjs-sm-sector-title"><span class="icon-settings fa fa-cog"></span> <span class="gjs-sm-sector-label">Settings</span></div>' +
        '<div class="gjs-sm-properties" style="display: none;"></div></div>'
    );
    var traitsProps = traitsSector.find(".gjs-sm-properties");
    traitsProps.append($(".gjs-trt-traits"));
    $(".gjs-sm-sectors").before(traitsSector);
    traitsSector.find(".gjs-sm-sector-title").on("click", function () {
      var traitStyle = traitsProps.get(0).style;
      var hidden = traitStyle.display == "none";
      if (hidden) {
        traitStyle.display = "block";
      } else {
        traitStyle.display = "none";
      }
    });

    // Open block manager
    var openBlocksBtn = editor.Panels.getButton("views", "open-blocks");
    openBlocksBtn && openBlocksBtn.set("active", 1);

    // Move Ad
    $("#gjs").append($(".ad-cont"));
  });

  (function (i, s, o, g, r, a, m) {
    i["GoogleAnalyticsObject"] = r;
    (i[r] =
      i[r] ||
      function () {
        (i[r].q = i[r].q || []).push(arguments);
      }),
      (i[r].l = 1 * new Date());
    (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m);
  })(
    window,
    document,
    "script",
    "//www.google-analytics.com/analytics.js",
    "ga"
  );

  ga("create", "UA-74284223-1", "auto");
  ga("send", "pageview");
  

  



// function loadExternalUrl() {
//     // Check if the current page URL matches the URL to skip
//     if (window.location.href === "http://127.0.0.1:5504/index.html") {
//         console.log("Skipping button click on the current page.");
//         return; // Exit the function without performing further actions
//     }

//     // Fetch the external URL
//     fetch("http://127.0.0.1:5504/index.html?priview")
//         .then(response => response.text())
//         .then(data => {
//             // Create a hidden div to hold the response HTML
//             const div = document.createElement("div");
//             div.style.display = "none";
//             div.innerHTML = data;
//             document.body.appendChild(div);

//             // Function to perform actions once the content is loaded
//             function contentLoaded() {
//                 // Find the button and log its length
//                 const button = $(".gjs-pn-btn").eq(5);
//                 console.log("Number of buttons found:", button.length);

//                 // Trigger the click event
//                 button.trigger("click");
//             }

//             // Check if the document is ready, if not, wait
//             if ($(document).readyState === "complete") {
//                 contentLoaded();
//             } else {
//                 $(document).ready(contentLoaded);
//             }
//         })
//         .catch(error => { 
//             console.error("Error loading external URL:", error);
//         });
// }

// // Load the external URL when the page loads
// window.addEventListener("load", loadExternalUrl);

// preview btn open in new tab


$(document).ready(function() {
  
  // const button = $(".gjs-pn-btn").eq(5);
  $(".gjs-pn-btn").eq(5).css({"pointer-events":"none"})

  

  $(".gjs-pn-buttons").eq(2).append('<span id="gjs-previewbtn" title="Preview" style="position: absolute;right: 160px;" class="gjs-pn-btns" data-tooltip-pos="bottom" data-tooltip="Preview"><svg style="display: block; max-width:22px" viewBox="0 0 24 24"><path fill="currentColor" d="M12,9A3,3 0 0,0 9,12A3,3 0 0,0 12,15A3,3 0 0,0 15,12A3,3 0 0,0 12,9M12,17A5,5 0 0,1 7,12A5,5 0 0,1 12,7A5,5 0 0,1 17,12A5,5 0 0,1 12,17M12,4.5C7,4.5 2.73,7.61 1,12C2.73,16.39 7,19.5 12,19.5C17,19.5 21.27,16.39 23,12C21.27,7.61 17,4.5 12,4.5Z"></path></svg></span>'); 

  // alert($('#gjs-previewbtn').length)

  // alert($(".gjs-pn-btn").length)  


  const button =  $("#gjs-previewbtn")

  
  button.click(function() {
    //open import poup
    $(".gjs-pn-btn").eq(10).trigger("click");
                  
    
    const codeMirrorInstance = document.querySelector('.CodeMirror').CodeMirror;

    // console.log('before get value', codeMirrorInstance.getValue());

    const presentValue = codeMirrorInstance.getValue();


    var currentDomain = window.location;
    


    localStorage.setItem("previewContentPortal",presentValue);

    //close import poup
    $(".gjs-mdl-btn-close").trigger("click");

    console.log(currentDomain+"preview.html")

    window.open(currentDomain+"preview.html", "_blank");
    
  });
});




// $(document).ready(function() {
  
//   // const uniqueIdentifier = ".gjs-block.gjs-one-bg.gjs-four-color-h.bacicElaments"; 

//   // // Add a "dragend" event listener to the specified element
//   // $(uniqueIdentifier).on("dragend", function(event) {
//   //   console.log("Drag end event fired for the specified element.");
//   //   console.log("Element where drag ended:", this);
//     const iframeElement = $('body iframe.gjs-frame');
//     if (iframeElement.length > 0) {
//       const iframeContent = iframeElement[0].contentDocument;
//       console.log("yes");
//     }
//   //   console.log("Event object:", event);
//   // });
//   const elementsWithClass = $("body").find(".gjs-clm-sel-id");
//         if (elementsWithClass.length > 0) {
//           let elementText = elementsWithClass.text();
//           let textWithoutPrefix = elementText.replace('ID: ', '');
//           const idToSearch = textWithoutPrefix;}




// });

















</script>

<!--  -->

</html>